

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  
  <meta charset="utf-8" />
  
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Fetch GPU Counter Data &mdash; RenderDoc documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/sphinx_paramlinks.css" type="text/css" />

  
  

  
  
    <link rel="canonical" href="https://renderdoc.org/docs/python_api/examples/renderdoc/fetch_counters.html"/>
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Save a texture to disk" href="save_texture.html" />
    <link rel="prev" title="Fetch Shader details" href="fetch_shader.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> RenderDoc
          

          
          </a>

          
            
            
              <div class="version">
                1.28
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../credits_acknowledgements.html">Credits &amp; Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/index.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../behind_scenes/index.html">Behind the scenes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../in_application_api.html">In-application API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Python API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../renderdoc_intro.html">Getting Started (python)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qrenderdoc_intro.html">Getting Started (RenderDoc UI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dev_environment.html">Python development environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ui_extensions.html">Writing UI extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics.html">Basic Interfaces</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">renderdoc Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="iter_actions.html">Iterate Action tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="fetch_shader.html">Fetch Shader details</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Fetch GPU Counter Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-source">Example Source</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="save_texture.html">Save a texture to disk</a></li>
<li class="toctree-l3"><a class="reference internal" href="decode_mesh.html">Decoding Mesh Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="display_window.html">Display texture in window</a></li>
<li class="toctree-l3"><a class="reference internal" href="remote_capture.html">Remote Capture and Replay</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../qrenderdoc/index.html">qrenderdoc examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../renderdoc/index.html">renderdoc API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../qrenderdoc/index.html">qrenderdoc API Reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../how/index.html">How do I …?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../window/index.html">Window reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">RenderDoc</a>
        
      </nav>
      


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
          
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Python API</a> &raquo;</li>
        
          <li><a href="index.html">renderdoc Examples</a> &raquo;</li>
        
      <li>Fetch GPU Counter Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/baldurk/renderdoc/blob/v1.28/docs/python_api/examples/renderdoc/fetch_counters.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="fetch-gpu-counter-data">
<h1>Fetch GPU Counter Data<a class="headerlink" href="#fetch-gpu-counter-data" title="Permalink to this heading">¶</a></h1>
<p>In this example we will gather GPU counter data over a capture and find any actions that completely failed the depth/stencil test.</p>
<p>The first thing we do is enumerate a list of counters that the implementation supports using <a class="reference internal" href="../../renderdoc/replay.html#renderdoc.ReplayController.EnumerateCounters" title="renderdoc.ReplayController.EnumerateCounters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">EnumerateCounters()</span></code></a>. A few of these counters values are statically known - see <a class="reference internal" href="../../renderdoc/counters.html#renderdoc.GPUCounter" title="renderdoc.GPUCounter"><code class="xref py py-class docutils literal notranslate"><span class="pre">GPUCounter</span></code></a>. If you know which counter you want ahead of time you can continue straight away by calling <a class="reference internal" href="../../renderdoc/replay.html#renderdoc.ReplayController.FetchCounters" title="renderdoc.ReplayController.FetchCounters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FetchCounters()</span></code></a> with a list of counters to sample from, or <a class="reference internal" href="../../renderdoc/replay.html#renderdoc.ReplayController.DescribeCounter" title="renderdoc.ReplayController.DescribeCounter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DescribeCounter()</span></code></a> to obtain a <a class="reference internal" href="../../renderdoc/counters.html#renderdoc.CounterDescription" title="renderdoc.CounterDescription"><code class="xref py py-class docutils literal notranslate"><span class="pre">CounterDescription</span></code></a> of the counter itself:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enumerate the available counters</span>
<span class="n">counters</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">EnumerateCounters</span><span class="p">()</span>

<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">GPUCounter</span><span class="o">.</span><span class="n">SamplesPassed</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Implementation doesn&#39;t support Samples Passed counter&quot;</span><span class="p">)</span>

<span class="c1"># Now we fetch the counter data, this is a good time to batch requests of as many</span>
<span class="c1"># counters as possible, the implementation handles any book keeping.</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">FetchCounters</span><span class="p">([</span><span class="n">rd</span><span class="o">.</span><span class="n">GPUCounter</span><span class="o">.</span><span class="n">SamplesPassed</span><span class="p">])</span>

<span class="c1"># Get the description for the counter we want</span>
<span class="n">samplesPassedDesc</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">DescribeCounter</span><span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">GPUCounter</span><span class="o">.</span><span class="n">SamplesPassed</span><span class="p">)</span>
</pre></div>
</div>
<p>However we will also print all available counters. If the implementation supports vendor-specific counters they will be enumerated as well and we can print their descriptions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Describe each counter</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">:</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">DescribeCounter</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Counter </span><span class="si">%d</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">):&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">desc</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Returns </span><span class="si">%d</span><span class="s2"> byte </span><span class="si">%s</span><span class="s2">, representing </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">desc</span><span class="o">.</span><span class="n">resultByteWidth</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">resultType</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
</pre></div>
</div>
<p>Once we have the list of <a class="reference internal" href="../../renderdoc/counters.html#renderdoc.CounterResult" title="renderdoc.CounterResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">CounterResult</span></code></a> from sampling the specified counters, each result returned is for one counter on one event. Since we only fetched one counter we can simply iterate over the results looking up the action for each. For actual draws (excluding clears and markers etc) we use the counter description to determine the data payload size, and get the value out. Interpreting this can either happen based on the description, or in our case we know that this counter returns a simple value we can check:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look in the results for any draws with 0 samples written - this is an indication</span>
<span class="c1"># that if a lot of draws appear then culling could be better.</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">draw</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">eventId</span><span class="p">]</span>

        <span class="c1"># Only care about draws, not about clears and other misc events</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">rd</span><span class="o">.</span><span class="n">ActionFlags</span><span class="o">.</span><span class="n">Drawcall</span><span class="p">):</span>
                <span class="k">continue</span>

        <span class="k">if</span> <span class="n">samplesPassedDesc</span><span class="o">.</span><span class="n">resultByteWidth</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">u32</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">u64</span>

        <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EID </span><span class="si">%d</span><span class="s2"> &#39;</span><span class="si">%s</span><span class="s2">&#39; had no samples pass depth/stencil test!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">eventId</span><span class="p">,</span> <span class="n">draw</span><span class="o">.</span><span class="n">GetName</span><span class="p">(</span><span class="n">controller</span><span class="o">.</span><span class="n">GetStructuredFile</span><span class="p">())))</span>
</pre></div>
</div>
<section id="example-source">
<h2>Example Source<a class="headerlink" href="#example-source" title="Permalink to this heading">¶</a></h2>
<p><a class="reference download internal" download="" href="../../../_downloads/f151b8a0b9141f5cdf19b0434b231f32/fetch_counters.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">the</span> <span class="pre">example</span> <span class="pre">script</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Import renderdoc if not already imported (e.g. in the UI)</span>
<span class="k">if</span> <span class="s1">&#39;renderdoc&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span> <span class="ow">and</span> <span class="s1">&#39;_renderdoc&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
	<span class="kn">import</span> <span class="nn">renderdoc</span>

<span class="c1"># Alias renderdoc for legibility</span>
<span class="n">rd</span> <span class="o">=</span> <span class="n">renderdoc</span>

<span class="n">actions</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Define a recursive function for iterating over actions</span>
<span class="k">def</span> <span class="nf">iterDraw</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
	<span class="k">global</span> <span class="n">actions</span>

	<span class="c1"># save the action by eventId</span>
	<span class="n">actions</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">eventId</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>

	<span class="c1"># Iterate over the draw&#39;s children</span>
	<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
		<span class="n">iterDraw</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39;    &#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sampleCode</span><span class="p">(</span><span class="n">controller</span><span class="p">):</span>
	<span class="c1"># Iterate over all of the root actions, so we have names for each</span>
	<span class="c1"># eventId</span>
	<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">controller</span><span class="o">.</span><span class="n">GetRootActions</span><span class="p">():</span>
		<span class="n">iterDraw</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

	<span class="c1"># Enumerate the available counters</span>
	<span class="n">counters</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">EnumerateCounters</span><span class="p">()</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">GPUCounter</span><span class="o">.</span><span class="n">SamplesPassed</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">):</span>
		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Implementation doesn&#39;t support Samples Passed counter&quot;</span><span class="p">)</span>

	<span class="c1"># Now we fetch the counter data, this is a good time to batch requests of as many</span>
	<span class="c1"># counters as possible, the implementation handles any book keeping.</span>
	<span class="n">results</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">FetchCounters</span><span class="p">([</span><span class="n">rd</span><span class="o">.</span><span class="n">GPUCounter</span><span class="o">.</span><span class="n">SamplesPassed</span><span class="p">])</span>

	<span class="c1"># Get the description for the counter we want</span>
	<span class="n">samplesPassedDesc</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">DescribeCounter</span><span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">GPUCounter</span><span class="o">.</span><span class="n">SamplesPassed</span><span class="p">)</span>

	<span class="c1"># Describe each counter</span>
	<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">counters</span><span class="p">:</span>
		<span class="n">desc</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">DescribeCounter</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Counter </span><span class="si">%d</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">):&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">desc</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Returns </span><span class="si">%d</span><span class="s2"> byte </span><span class="si">%s</span><span class="s2">, representing </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">desc</span><span class="o">.</span><span class="n">resultByteWidth</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">resultType</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>

	<span class="c1"># Look in the results for any draws with 0 samples written - this is an indication</span>
	<span class="c1"># that if a lot of draws appear then culling could be better.</span>
	<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
		<span class="n">draw</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">eventId</span><span class="p">]</span>

		<span class="c1"># Only care about draws, not about clears and other misc events</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">rd</span><span class="o">.</span><span class="n">ActionFlags</span><span class="o">.</span><span class="n">Drawcall</span><span class="p">):</span>
			<span class="k">continue</span>

		<span class="k">if</span> <span class="n">samplesPassedDesc</span><span class="o">.</span><span class="n">resultByteWidth</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
			<span class="n">val</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">u32</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">val</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">u64</span>

		<span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EID </span><span class="si">%d</span><span class="s2"> &#39;</span><span class="si">%s</span><span class="s2">&#39; had no samples pass depth/stencil test!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">eventId</span><span class="p">,</span> <span class="n">draw</span><span class="o">.</span><span class="n">GetName</span><span class="p">(</span><span class="n">controller</span><span class="o">.</span><span class="n">GetStructuredFile</span><span class="p">())))</span>

<span class="k">def</span> <span class="nf">loadCapture</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
	<span class="c1"># Open a capture file handle</span>
	<span class="n">cap</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">OpenCaptureFile</span><span class="p">()</span>

	<span class="c1"># Open a particular file - see also OpenBuffer to load from memory</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">cap</span><span class="o">.</span><span class="n">OpenFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

	<span class="c1"># Make sure the file opened successfully</span>
	<span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="n">rd</span><span class="o">.</span><span class="n">ResultCode</span><span class="o">.</span><span class="n">Succeeded</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t open file: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>

	<span class="c1"># Make sure we can replay</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">cap</span><span class="o">.</span><span class="n">LocalReplaySupport</span><span class="p">():</span>
		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Capture cannot be replayed&quot;</span><span class="p">)</span>

	<span class="c1"># Initialise the replay</span>
	<span class="n">result</span><span class="p">,</span><span class="n">controller</span> <span class="o">=</span> <span class="n">cap</span><span class="o">.</span><span class="n">OpenCapture</span><span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">ReplayOptions</span><span class="p">(),</span> <span class="kc">None</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">result</span> <span class="o">!=</span> <span class="n">rd</span><span class="o">.</span><span class="n">ResultCode</span><span class="o">.</span><span class="n">Succeeded</span><span class="p">:</span>
		<span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t initialise replay: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>

	<span class="k">return</span> <span class="n">cap</span><span class="p">,</span><span class="n">controller</span>

<span class="k">if</span> <span class="s1">&#39;pyrenderdoc&#39;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
	<span class="n">pyrenderdoc</span><span class="o">.</span><span class="n">Replay</span><span class="p">()</span><span class="o">.</span><span class="n">BlockInvoke</span><span class="p">(</span><span class="n">sampleCode</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
	<span class="n">rd</span><span class="o">.</span><span class="n">InitialiseReplay</span><span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">GlobalEnvironment</span><span class="p">(),</span> <span class="p">[])</span>

	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Usage: python3 </span><span class="si">{}</span><span class="s1"> filename.rdc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
		<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

	<span class="n">cap</span><span class="p">,</span><span class="n">controller</span> <span class="o">=</span> <span class="n">loadCapture</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

	<span class="n">sampleCode</span><span class="p">(</span><span class="n">controller</span><span class="p">)</span>

	<span class="n">controller</span><span class="o">.</span><span class="n">Shutdown</span><span class="p">()</span>
	<span class="n">cap</span><span class="o">.</span><span class="n">Shutdown</span><span class="p">()</span>

	<span class="n">rd</span><span class="o">.</span><span class="n">ShutdownReplay</span><span class="p">()</span>

</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Counter 1 (GPU Duration):
    Time taken for this event on the GPU, as measured by delta between two GPU timestamps.
    Returns 8 byte CompType.Float, representing CounterUnit.Seconds
Counter 2 (Input Vertices Read):
    Number of vertices read by input assembler.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 3 (Input Primitives):
    Number of primitives read by the input assembler.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 4 (GS Primitives):
    Number of primitives output by a geometry shader.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 5 (Rasterizer Invocations):
    Number of primitives that were sent to the rasterizer.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 6 (Rasterized Primitives):
    Number of primitives that were rendered.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 7 (Samples Passed):
    Number of samples that passed depth/stencil test.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
    ... which we will sample
Counter 8 (VS Invocations):
    Number of times a vertex shader was invoked.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 9 (HS Invocations):
    Number of times a hull shader was invoked.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 10 (DS Invocations):
    Number of times a domain shader (or tesselation evaluation shader in OpenGL) was invoked.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 11 (GS Invocations):
    Number of times a geometry shader was invoked.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 12 (PS Invocations):
    Number of times a pixel shader was invoked.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
Counter 13 (CS Invocations):
    Number of times a compute shader was invoked.
    Returns 8 byte CompType.UInt, representing CounterUnit.Absolute
EID 69 &#39;DrawIndexed()&#39; had no samples pass depth/stencil test!
EID 82 &#39;DrawIndexed()&#39; had no samples pass depth/stencil test!
EID 95 &#39;DrawIndexed()&#39; had no samples pass depth/stencil test!
EID 108 &#39;DrawIndexed()&#39; had no samples pass depth/stencil test!
EID 199 &#39;DrawIndexed()&#39; had no samples pass depth/stencil test!
EID 212 &#39;DrawIndexed()&#39; had no samples pass depth/stencil test!
EID 225 &#39;DrawIndexed()&#39; had no samples pass depth/stencil test!
EID 238 &#39;DrawIndexed()&#39; had no samples pass depth/stencil test!
</pre></div>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="save_texture.html" class="btn btn-neutral float-right" title="Save a texture to disk" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="fetch_shader.html" class="btn btn-neutral float-left" title="Fetch Shader details" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Baldur Karlsson.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
  

  
  
    
   

</body>
</html>